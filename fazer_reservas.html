<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservar Mesa</title>
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="fazer_reserva.css">
</head>
<body>

    <h1 class="fonteH1">Formulário de Reserva</h1>

    <form id="formReserva">
        <label for="Solicitante">Nome do Solicitante:</label>
        <input type="text" id="Solicitante" required>

        <label for="UserCPF">CPF:</label>
        <input type="text" id="UserCPF" required>

        <label for="DataReserva">Data da Reserva:</label>
        <input type="date" id="DataReserva" required>

        <label for="HoraChegada">Hora de Chegada:</label>
        <input type="time" id="HoraChegada" required>

        <label for="HoraSaida">Hora de Saída:</label>
        <input type="time" id="HoraSaida" required>

        <label for="TotalPessoas">Total de Pessoas:</label>
        <input type="number" id="TotalPessoas" min="1" required>

        <label for="Contato">Contato:</label>
        <input type="text" id="Contato" required>

        <button type="submit">Reservar</button>
    </form>

    <a href="ver_reservas.html">Ver Reservas</a>

    <script>
        const TAXA = 100;
        const MinimoParaTaxa = 10;
        let totalVagas = 200;

        let check = localStorage.getItem("TotalVagas");

        if (check !== null) {
            totalVagas = JSON.parse(localStorage.getItem("TotalVagas"));
        }

        document.getElementById("formReserva").addEventListener("submit", function(event) {
            event.preventDefault();
            if (totalVagas >= parseInt(document.getElementById("TotalPessoas").value)) {
                const reserva = {
                    solicitante: document.getElementById("Solicitante").value,
                    cpf: document.getElementById("UserCPF").value,
                    dataReserva: document.getElementById("DataReserva").value,
                    horaChegada: document.getElementById("HoraChegada").value,
                    horaSaida: document.getElementById("HoraSaida").value,
                    totalDePessoas: parseInt(document.getElementById("TotalPessoas").value),
                    contato: document.getElementById("Contato").value,
                    taxaDaReserva: parseInt(document.getElementById("TotalPessoas").value / MinimoParaTaxa) * TAXA
                };

                let reservas = JSON.parse(localStorage.getItem("reservas")) || [];
                reservas.push(reserva);
                localStorage.setItem("reservas", JSON.stringify(reservas));
                totalVagas -= parseInt(document.getElementById("TotalPessoas").value);
                localStorage.setItem("TotalVagas", JSON.stringify(totalVagas));
                this.reset();
            } else {
                alert("Vagas indisponíveis!!!");
            }
        });
    </script>
</body>
</html>
